(this["webpackJsonpcurrency-exchange"]=this["webpackJsonpcurrency-exchange"]||[]).push([[0],{28:function(e,n,t){e.exports=t(41)},33:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(21),o=t.n(c),u=(t(33),t(6)),i=t(7),l=t(2),s=t(3);function m(){var e=Object(l.a)([""]);return m=function(){return e},e}var d=function(e){switch(e){case"outline":return"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded";default:return"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}},f=s.a.button.attrs((function(e){return{className:d(e.type)}}))(m());function v(){var e=Object(l.a)([""]);return v=function(){return e},e}s.a.nav(v());function E(){var e=Object(l.a)(["\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-50%);\n"]);return E=function(){return e},e}var b=s.a.div(E());function p(){var e=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  & > * {\n    flex: 1 auto;\n    width: 50%;\n  }\n"]);return p=function(){return e},e}var g=s.a.div(p()),h=function(){return r.a.createElement(b,{"data-testid":"home"},r.a.createElement(f,{as:u.b,to:"/welcome",className:"block m-2"},"Start"))},y=function(){return r.a.createElement(b,null,r.a.createElement("header",null,r.a.createElement("h1",{className:"text-4xl pb-2"},"Welcome to Currency Exchange")),r.a.createElement("section",{className:"text-center p-2"},r.a.createElement("p",null,"Please select your preferred Currency in settings."),r.a.createElement("p",null,"We have set it ourselves to EUR and credited your account some initial fund to play with the app"),r.a.createElement("small",{className:"block italic"},"P.S. This fund can not be used to do any real purchase")),r.a.createElement(f,{as:u.b,to:"/exchange",className:"m-2 inline-block"},"Exchange"))},O=t(18),j=t.n(O),C=t(26),x=t(9),A=t(1),N={currency:"EUR",loading:!1,rates:{}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,n=arguments.length>1?arguments[1]:void 0,t=n.type,a=n.payload;switch(t){case"RATES_LOADING":return Object(A.a)({},e,{loading:!0});case"RATES_RECEIVED":return Object(A.a)({},e,{loading:!1},a);case"BASE_CURRENCY_CHANGED":return Object(A.a)({},e,{},a);default:return e}},T={RATES:"/latest",CURRENCIES:"/currencies"},D="//api.frankfurter.app",R=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a="".concat(D).concat(e),r=new Headers;r.append("Content-Type","application/json");var c={method:n,headers:r};return["POST","PUT"].includes(n)&&(c.body="string"!==typeof t?JSON.stringify(t):t),fetch(a,c).then((function(e){return 204===e.status?{}:e.json()}))},w=function(e){return R(e,"GET")},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={};e&&(n.from=e);var t=new URLSearchParams(n);return w("".concat(T.RATES,"?").concat(t.toString()))},_=t(27),P=t(8),k={base:"EUR",poll:1e4,currencies:["EUR","GBP","USD"],balances:{EUR:100,GBP:0,USD:0},transactions:[]},I=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload,c=n.balances,o=n.transactions,u=void 0===o?[]:o;switch(a){case"SETTINGS_UPDATED":return Object(A.a)({},n,{},r);case"EXCHANGE_INITIATED":if(!(null===r||void 0===r?void 0:r.from.amount)||(null===r||void 0===r?void 0:r.from.amount)<=0)return n;if(!(null===r||void 0===r?void 0:r.from.currency)||!(null===r||void 0===r?void 0:r.to.currency))return n;var i=c[null===r||void 0===r?void 0:r.from.currency];if(i<(null===r||void 0===r?void 0:r.from.amount))return n;var l=c[null===r||void 0===r?void 0:r.to.currency],s=null===r||void 0===r?void 0:r.from.amount,m=null===r||void 0===r?void 0:r.to.amount,d={balances:(e={},Object(P.a)(e,null===r||void 0===r?void 0:r.from.currency,i-s),Object(P.a)(e,null===r||void 0===r?void 0:r.to.currency,l+m),e),transactions:[Object(A.a)({},r,{timestamp:Number(new Date)})].concat(Object(_.a)(u))};return Object(A.a)({},n,{},d);default:return n}},B="currency-exchange",G=window.localStorage,Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=G.getItem(B),t=n?JSON.parse(n):{};return e?t[e]:t},H=Y,z=function(e,n){G.setItem(B,JSON.stringify(Object(A.a)({},Y(),Object(P.a)({},e,n))))},X=function(e,n){z(e,n)},W=r.a.createContext({settings:k,updateSettings:function(){},exchangeAmount:function(){}}),J=W.Provider,M=(W.Consumer,function(e){var n=e.children,t=Object(a.useReducer)(I,k),c=Object(x.a)(t,2),o=c[0],u=c[1],i=Object(a.useRef)(0);Object(a.useEffect)((function(){l(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return H(e)}("app"))}),[]),Object(a.useEffect)((function(){i.current&&function(e){var n=Number(new Date);i.current=n,X("app",e),X("timestamp",n)}(o)}),[o]);var l=function(e){u({type:"SETTINGS_UPDATED",payload:e})},s={settings:o,updateSettings:l,exchangeAmount:function(e){u({type:"EXCHANGE_INITIATED",payload:e})}};return r.a.createElement(J,{value:s},n)}),F=W,V=r.a.createContext(Object(A.a)({},N,{updateBaseCurrency:function(){}})),L=V.Provider,$=(V.Consumer,function(e){var n=e.children,t=Object(a.useContext)(F).settings,c=Object(a.useState)(t.base),o=Object(x.a)(c,2),u=o[0],i=o[1],l=Object(a.useReducer)(S,N),s=Object(x.a)(l,2),m=s[0],d=s[1],f=Object(a.useRef)(0);return Object(a.useEffect)((function(){var e=function(){f.current=setTimeout(n,t.poll)},n=function(){d({type:"RATES_LOADING"}),Object(C.a)(j.a.mark((function n(){var t,a,r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U(u);case 2:t=n.sent,a=t.rates,r=void 0===a?{}:a,e(),d({type:"RATES_RECEIVED",payload:{rates:r,currency:u}});case 7:case"end":return n.stop()}}),n)})))()};return n(),function(){f.current&&clearTimeout(f.current)}}),[t.poll,u]),r.a.createElement(L,{value:Object(A.a)({},m,{updateBaseCurrency:i})},n)}),q=V;function K(){var e=Object(l.a)(["\n  text-align: right;\n  padding-right: 0.4rem;\n"]);return K=function(){return e},e}function Q(){var e=Object(l.a)(["\n  text-align: left;\n  padding-left: 0.4rem;\n"]);return Q=function(){return e},e}function Z(){var e=Object(l.a)(["\n  font-size: 0.8rem;\n  opacity: 0.8;\n  padding: 0 1rem;\n"]);return Z=function(){return e},e}function ee(){var e=Object(l.a)(["\n  max-width: 320px;\n  padding: 1rem 0;\n  border: 1px solid #efefef;\n  border-radius: 10px;\n  box-shadow: 0 0 10px 0 rgba(100, 100, 100, 0.3);\n"]);return ee=function(){return e},e}var ne=s.a.div(ee()),te=Object(s.a)(g)(Z()),ae=s.a.div(Q()),re=s.a.div(K());function ce(){var e=Object(l.a)(["\n  --size: 1.8rem;\n  width: var(--size);\n  height: var(--size);\n  line-height: var(--size);\n  border-radius: 50%;\n  position: absolute;\n  padding: 0;\n  left: 0;\n"]);return ce=function(){return e},e}function oe(){var e=Object(l.a)(["\n  border: 1px solid #dfdfdf;\n  outline: none;\n  border-radius: 1rem;\n  padding: 0 0.5rem;\n  background: white;\n  transform: translateY(-50%);\n  margin-left: 15%;\n  &:focus,\n  &:active {\n    outline: none;\n    box-shadow: 0 0 5px 0 rgba(100, 100, 100, 0.2);\n  }\n"]);return oe=function(){return e},e}function ue(){var e=Object(l.a)(["\n  position: relative;\n  height: 1px;\n  margin: 2rem 0;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  background: #dfdfdf;\n"]);return ue=function(){return e},e}var ie=s.a.div(ue()),le=s.a.button(oe()),se=Object(s.a)(le)(ce()),me=function(e){var n=e.values,t=e.onSwitchClick;return r.a.createElement(ie,{"data-testid":"separator"},r.a.createElement(se,{onClick:function(){return t()},"data-testid":"separator-switch-button"},"\u21c5"),r.a.createElement(le,null,n.from," \u2192 ",n.to))};function de(){var e=Object(l.a)(["\n  appearance: none;\n  -moz-appearance: none;\n  -webkit-appearance: none;\n  background: transparent;\n"]);return de=function(){return e},e}var fe=s.a.select(de()),ve=function(e){var n=e.currencies,t=e.value,a=void 0===t?"":t,c=e.onChange,o=void 0===c?function(){}:c;return r.a.createElement("div",null,r.a.createElement(fe,{"data-testid":"currency-select",defaultValue:a,onChange:function(e){var n=e.target.value;return o(n)}},n.map((function(e){return r.a.createElement("option",{key:e},e)}))))};function Ee(){var e=Object(l.a)(['\n  text-align: right;\n  position: relative;\n  &:before {\n    content: "-";\n    position: absolute;\n    left: 0;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n']);return Ee=function(){return e},e}var be=s.a.input(Ee()),pe=function(e){return r.a.createElement("div",null,r.a.createElement(be,Object.assign({type:"tel",placeholder:"0"},e,{"data-testid":"amount-input"})))};function ge(){var e=Object(l.a)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n  & input,\n  & select {\n    font-size: 2rem;\n    max-width: 100%;\n    display: block;\n    background: transparent;\n    outline: none;\n  }\n"]);return ge=function(){return e},e}var he=Object(s.a)(g)(ge()),ye=function(e){var n=e.state,t=e.currencies,a=e.children,c=void 0===a?null:a,o=e.onCurrencyChange,u=void 0===o?function(){}:o,i=e.onAmountChange,l=void 0===i?function(){}:i,s=n.amount?Number(n.amount.toFixed(2)):"";return r.a.createElement(r.a.Fragment,null,r.a.createElement(he,{"data-testid":"exchange-participant"},r.a.createElement(ve,{key:n.currency,value:n.currency,currencies:t,onChange:u}),r.a.createElement(pe,{defaultValue:s,onChange:function(e){var n=Number(e.target.value);isNaN(n)||l(n)}})),c)},Oe={from:{amount:null,currency:"EUR"},to:{amount:null,currency:"GBP"},rate:null},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,n=arguments.length>1?arguments[1]:void 0,t=n.type,a=n.payload,r=void 0===a?{}:a,c=r.value,o=e.rate||0;switch(t){case"EXCHANGE_SWITCHED":return Object(A.a)({},e,{from:e.to,to:e.from});case"BASE_CURRENCY_UPDATED":return Object(A.a)({},e,{to:e.to.currency===c?{amount:e.to.amount,currency:e.from.currency}:e.to,from:Object(A.a)({},e.from,{currency:c})});case"SECONDARY_CURRENCY_UPDATED":return Object(A.a)({},e,{from:e.from.currency===c?{amount:e.from.amount,currency:e.to.currency}:e.from,to:Object(A.a)({},e.to,{currency:c})});case"BASE_AMOUNT_UPDATED":return Object(A.a)({},e,{from:Object(A.a)({},e.from,{amount:isNaN(c)?0:c}),to:Object(A.a)({},e.to,{amount:o?c*o:e.to.amount})});case"SECONDARY_AMOUNT_UPDATED":return Object(A.a)({},e,{from:Object(A.a)({},e.from,{amount:o?c/o:e.from.amount}),to:Object(A.a)({},e.to,{amount:isNaN(c)?0:c})});case"RATES_UPDATED":return Object(A.a)({},e,{rate:r.rates[e.to.currency]||o});case"RESET_EXCHANGE":return Object(A.a)({},e,{from:Object(A.a)({},e.from,{amount:0}),to:Object(A.a)({},e.to,{amount:0})});default:return e}},Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Number(e).toFixed(n)},xe=function(e){var n=e.currencies,t=Object(a.useContext)(q),c=Object(a.useContext)(F),o=c.settings,u=c.exchangeAmount,i=null,l=Object(a.useReducer)(je,Object(A.a)({},Oe,{from:{currency:o.base,amount:null}})),s=Object(x.a)(l,2),m=s[0],d=s[1];Object(a.useEffect)((function(){d({type:"RATES_UPDATED",payload:{rates:t.rates}})}),[t]),Object(a.useEffect)((function(){d({type:"RESET_EXCHANGE"})}),[o.balances]);var v=Object.keys(n),E=o.balances[m.from.currency];m.from.amount>E&&(i="Insufficient Balance");var p=t.loading&&!m.rate?{from:"\u22c5\u22c5\u22c5",to:"\u22c5\u22c5\u22c5"}:{from:"".concat(n[m.from.currency]," 1"),to:"".concat(n[m.to.currency]," ").concat(Ce(m.rate))};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),u(m),e.target.reset()},"data-testid":"exchange-form"},r.a.createElement(b,null,r.a.createElement(ne,null,r.a.createElement(ye,{state:m.from,currencies:v,onCurrencyChange:function(e){t.updateBaseCurrency(e),d({type:"BASE_CURRENCY_UPDATED",payload:{value:e}})},onAmountChange:function(e){d({type:"BASE_AMOUNT_UPDATED",payload:{value:e}})}},r.a.createElement(te,null,r.a.createElement(ae,null,"Balance: ",Ce(E)),r.a.createElement(re,null,i||""))),r.a.createElement(me,{values:p,onSwitchClick:function(){t.updateBaseCurrency(m.to.currency),d({type:"EXCHANGE_SWITCHED"})}}),r.a.createElement(ye,{state:m.to,currencies:v,onCurrencyChange:function(e){d({type:"SECONDARY_CURRENCY_UPDATED",payload:{value:e}})},onAmountChange:function(e){d({type:"SECONDARY_AMOUNT_UPDATED",payload:{value:e}})}},r.a.createElement(te,null,r.a.createElement(ae,null,"Balance:"," ",Ce(o.balances[m.to.currency])))),r.a.createElement(f,{className:"m-2 inline-block",type:"submit"},"Exchange"))))},Ae={EUR:"\u20ac",GBP:"\xa3",USD:"$"},Ne=function(){return r.a.createElement($,null,r.a.createElement(xe,{currencies:Ae}),r.a.createElement(u.b,{to:"/settings"},"Settings"))},Se=function(){var e=Object(a.useContext)(F).settings;return r.a.createElement("div",null,r.a.createElement("h1",null,"Transactions"),((null===e||void 0===e?void 0:e.transactions)||[]).map((function(e){return r.a.createElement(r.a.Fragment,null,e.rate)})))};var Te=function(){return r.a.createElement(M,null,r.a.createElement("div",{className:"bg-gray-200","data-testid":"app"},r.a.createElement("div",{className:"container min-h-screen p-2 box-border mx-auto relative text-center"},r.a.createElement(u.a,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/transactions"},r.a.createElement(Se,null)),r.a.createElement(i.a,{path:"/exchange"},r.a.createElement(Ne,null)),r.a.createElement(i.a,{path:"/welcome"},r.a.createElement(y,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(h,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.e48f6ead.chunk.js.map