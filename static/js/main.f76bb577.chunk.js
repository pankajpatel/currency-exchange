(this["webpackJsonpcurrency-exchange"]=this["webpackJsonpcurrency-exchange"]||[]).push([[0],{28:function(e,t,n){e.exports=n(41)},33:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),o=n.n(c),l=(n(33),n(4)),u=n(7),i=n(2),s=n(3);function m(){var e=Object(i.a)([""]);return m=function(){return e},e}var d=function(e){switch(e){case"outline":return"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded";default:return"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}},f=s.a.button.attrs((function(e){return{className:d(e.type)}}))(m());function E(){var e=Object(i.a)([""]);return E=function(){return e},e}s.a.nav(E());function b(){var e=Object(i.a)(["\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-50%);\n"]);return b=function(){return e},e}var p=s.a.div(b());function v(){var e=Object(i.a)(["\n  display: flex;\n  align-items: center;\n  & > * {\n    flex: 1 auto;\n    width: 50%;\n  }\n"]);return v=function(){return e},e}var h=s.a.div(v());function g(){var e=Object(i.a)(["\n  max-width: ",";\n  width: ",";\n  padding: 1rem 0;\n  border: 1px solid #efefef;\n  border-radius: 10px;\n  box-shadow: 0 0 10px 0 rgba(100, 100, 100, 0.3);\n"]);return g=function(){return e},e}var y=s.a.div(g(),(function(e){return e.width||"320px"}),(function(e){return e.width||"auto"}));function x(){var e=Object(i.a)(["\n  display: inline-block;\n  border: 1px solid #dedede;\n  padding: 0.3rem 0.8rem;\n  display: table-cell;\n"]);return x=function(){return e},e}function O(){var e=Object(i.a)(["\n  border-radius: 5px;\n  border: 1px solid #dedede;\n  list-style: none;\n  padding: 0;\n  display: table-row;\n"]);return O=function(){return e},e}function j(){var e=Object(i.a)(["\n  display: table;\n  width: auto;\n  margin: 0.5rem auto;\n  border-collapse: collapse;\n"]);return j=function(){return e},e}var N=s.a.div(j()),C=s.a.ul(O()),w=s.a.li(x()),A=function(){return r.a.createElement(p,{"data-testid":"home"},r.a.createElement(f,{as:l.b,to:"/welcome",className:"block m-2"},"Start"))},S=function(){return r.a.createElement(p,null,r.a.createElement("header",null,r.a.createElement("h1",{className:"text-4xl pb-2"},"Welcome to Currency Exchange")),r.a.createElement("section",{className:"text-center p-2"},r.a.createElement("p",null,"Please select your preferred Currency in settings."),r.a.createElement("p",null,"We have set it ourselves to EUR and credited your account some initial fund to play with the app"),r.a.createElement("small",{className:"block italic"},"P.S. This fund can not be used to do any real purchase")),r.a.createElement(f,{as:l.b,to:"/exchange",className:"m-2 inline-block"},"Exchange"))},T=n(18),D=n.n(T),R=n(26),U=n(9),_=n(1),k={currency:"EUR",loading:!1,rates:{}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"RATES_LOADING":return Object(_.a)({},e,{loading:!0});case"RATES_RECEIVED":return Object(_.a)({},e,{loading:!1},a);case"BASE_CURRENCY_CHANGED":return Object(_.a)({},e,{},a);default:return e}},B={RATES:"/latest",CURRENCIES:"/currencies"},I="//api.frankfurter.app",G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a="".concat(I).concat(e),r=new Headers;r.append("Content-Type","application/json");var c={method:t,headers:r};return["POST","PUT"].includes(t)&&(c.body="string"!==typeof n?JSON.stringify(n):n),fetch(a,c).then((function(e){return 204===e.status?{}:e.json()}))},Y=function(e){return G(e,"GET")},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={};e&&(t.from=e);var n=new URLSearchParams(t);return Y("".concat(B.RATES,"?").concat(n.toString()))},z=n(27),W=n(8),X={base:"EUR",poll:1e4,currencies:["EUR","GBP","USD"],balances:{EUR:100,GBP:0,USD:0},transactions:[]},J=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,n=arguments.length>1?arguments[1]:void 0,a=n.type,r=n.payload,c=t.balances,o=t.transactions,l=void 0===o?[]:o;switch(a){case"SETTINGS_UPDATED":return Object(_.a)({},t,{},r);case"EXCHANGE_INITIATED":if(!(null===r||void 0===r?void 0:r.from.amount)||(null===r||void 0===r?void 0:r.from.amount)<=0)return t;if(!(null===r||void 0===r?void 0:r.from.currency)||!(null===r||void 0===r?void 0:r.to.currency))return t;var u=c[null===r||void 0===r?void 0:r.from.currency];if(u<(null===r||void 0===r?void 0:r.from.amount))return t;var i=c[null===r||void 0===r?void 0:r.to.currency],s=null===r||void 0===r?void 0:r.from.amount,m=null===r||void 0===r?void 0:r.to.amount,d={balances:(e={},Object(W.a)(e,null===r||void 0===r?void 0:r.from.currency,u-s),Object(W.a)(e,null===r||void 0===r?void 0:r.to.currency,i+m),e),transactions:[Object(_.a)({},r,{timestamp:Number(new Date)})].concat(Object(z.a)(l))};return Object(_.a)({},t,{},d);default:return t}},M="currency-exchange",L=window.localStorage,V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=L.getItem(M),n=t?JSON.parse(t):{};return e?n[e]:n},F=V,$=function(e,t){L.setItem(M,JSON.stringify(Object(_.a)({},V(),Object(W.a)({},e,t))))},q=function(e,t){$(e,t)},K=r.a.createContext({settings:X,updateSettings:function(){},exchangeAmount:function(){}}),Q=K.Provider,Z=(K.Consumer,function(e){var t=e.children,n=Object(a.useReducer)(J,X),c=Object(U.a)(n,2),o=c[0],l=c[1];Object(a.useEffect)((function(){u(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return F(e)}("app"))}),[]),Object(a.useEffect)((function(){!function(e){var t=Number(new Date);q("app",e),q("timestamp",t)}(o)}),[o]);var u=function(e){l({type:"SETTINGS_UPDATED",payload:e})},i={settings:o,updateSettings:u,exchangeAmount:function(e){l({type:"EXCHANGE_INITIATED",payload:e})}};return r.a.createElement(Q,{value:i},t)}),ee=K,te=r.a.createContext(Object(_.a)({},k,{updateBaseCurrency:function(){}})),ne=te.Provider,ae=(te.Consumer,function(e){var t=e.children,n=Object(a.useContext)(ee).settings,c=Object(a.useState)(n.base),o=Object(U.a)(c,2),l=o[0],u=o[1],i=Object(a.useReducer)(P,k),s=Object(U.a)(i,2),m=s[0],d=s[1],f=Object(a.useRef)(0);return Object(a.useEffect)((function(){var e=function(){f.current=setTimeout(t,n.poll)},t=function(){d({type:"RATES_LOADING"}),Object(R.a)(D.a.mark((function t(){var n,a,r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H(l);case 2:n=t.sent,a=n.rates,r=void 0===a?{}:a,e(),d({type:"RATES_RECEIVED",payload:{rates:r,currency:l}});case 7:case"end":return t.stop()}}),t)})))()};return t(),function(){f.current&&clearTimeout(f.current)}}),[n.poll,l]),r.a.createElement(ne,{value:Object(_.a)({},m,{updateBaseCurrency:u})},t)}),re=te;function ce(){var e=Object(i.a)(["\n  text-align: right;\n  padding-right: 0.4rem;\n"]);return ce=function(){return e},e}function oe(){var e=Object(i.a)(["\n  text-align: left;\n  padding-left: 0.4rem;\n"]);return oe=function(){return e},e}function le(){var e=Object(i.a)(["\n  font-size: 0.8rem;\n  opacity: 0.8;\n  padding: 0 1rem;\n"]);return le=function(){return e},e}var ue=Object(s.a)(h)(le()),ie=s.a.div(oe()),se=s.a.div(ce());function me(){var e=Object(i.a)(["\n  --size: 1.8rem;\n  width: var(--size);\n  height: var(--size);\n  line-height: var(--size);\n  border-radius: 50%;\n  position: absolute;\n  padding: 0;\n  left: 0;\n"]);return me=function(){return e},e}function de(){var e=Object(i.a)(["\n  border: 1px solid #dfdfdf;\n  outline: none;\n  border-radius: 1rem;\n  padding: 0 0.5rem;\n  background: white;\n  transform: translateY(-50%);\n  margin-left: 15%;\n  &:focus,\n  &:active {\n    outline: none;\n    box-shadow: 0 0 5px 0 rgba(100, 100, 100, 0.2);\n  }\n"]);return de=function(){return e},e}function fe(){var e=Object(i.a)(["\n  position: relative;\n  height: 1px;\n  margin: 2rem 0;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  background: #dfdfdf;\n"]);return fe=function(){return e},e}var Ee=s.a.div(fe()),be=s.a.button(de()),pe=Object(s.a)(be)(me()),ve=function(e){var t=e.values,n=e.onSwitchClick;return r.a.createElement(Ee,{"data-testid":"separator"},r.a.createElement(pe,{onClick:function(){return n()},"data-testid":"separator-switch-button"},"\u21c5"),r.a.createElement(be,null,t.from," \u2192 ",t.to))};function he(){var e=Object(i.a)(["\n  appearance: none;\n  -moz-appearance: none;\n  -webkit-appearance: none;\n  background: transparent;\n"]);return he=function(){return e},e}var ge=s.a.select(he()),ye=function(e){var t=e.currencies,n=e.value,a=void 0===n?"":n,c=e.onChange,o=void 0===c?function(){}:c;return r.a.createElement("div",null,r.a.createElement(ge,{"data-testid":"currency-select",defaultValue:a,onChange:function(e){var t=e.target.value;return o(t)}},t.map((function(e){return r.a.createElement("option",{key:e},e)}))))};function xe(){var e=Object(i.a)(['\n  text-align: right;\n  position: relative;\n  &:before {\n    content: "-";\n    position: absolute;\n    left: 0;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n']);return xe=function(){return e},e}var Oe=s.a.input(xe()),je=function(e){return r.a.createElement("div",null,r.a.createElement(Oe,Object.assign({type:"tel",placeholder:"0"},e,{"data-testid":"amount-input"})))};function Ne(){var e=Object(i.a)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n  & input,\n  & select {\n    font-size: 2rem;\n    max-width: 100%;\n    display: block;\n    background: transparent;\n    outline: none;\n  }\n"]);return Ne=function(){return e},e}var Ce=Object(s.a)(h)(Ne()),we=function(e){var t=e.state,n=e.currencies,a=e.children,c=void 0===a?null:a,o=e.onCurrencyChange,l=void 0===o?function(){}:o,u=e.onAmountChange,i=void 0===u?function(){}:u,s=t.amount?Number(t.amount.toFixed(2)):"";return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,{"data-testid":"exchange-participant"},r.a.createElement(ye,{key:t.currency,value:t.currency,currencies:n,onChange:l}),r.a.createElement(je,{defaultValue:s,onChange:function(e){var t=Number(e.target.value);isNaN(t)||i(t)}})),c)},Ae={from:{amount:null,currency:"EUR"},to:{amount:null,currency:"GBP"},rate:null},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=void 0===a?{}:a,c=r.value,o=e.rate||0;switch(n){case"EXCHANGE_SWITCHED":return Object(_.a)({},e,{from:e.to,to:e.from});case"BASE_CURRENCY_UPDATED":return Object(_.a)({},e,{to:e.to.currency===c?{amount:e.to.amount,currency:e.from.currency}:e.to,from:Object(_.a)({},e.from,{currency:c})});case"SECONDARY_CURRENCY_UPDATED":return Object(_.a)({},e,{from:e.from.currency===c?{amount:e.from.amount,currency:e.to.currency}:e.from,to:Object(_.a)({},e.to,{currency:c})});case"BASE_AMOUNT_UPDATED":return Object(_.a)({},e,{from:Object(_.a)({},e.from,{amount:isNaN(c)?0:c}),to:Object(_.a)({},e.to,{amount:o?c*o:e.to.amount})});case"SECONDARY_AMOUNT_UPDATED":return Object(_.a)({},e,{from:Object(_.a)({},e.from,{amount:o?c/o:e.from.amount}),to:Object(_.a)({},e.to,{amount:isNaN(c)?0:c})});case"RATES_UPDATED":return Object(_.a)({},e,{rate:r.rates[e.to.currency]||o});case"RESET_EXCHANGE":return Object(_.a)({},e,{from:Object(_.a)({},e.from,{amount:0}),to:Object(_.a)({},e.to,{amount:0})});default:return e}},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Number(e).toFixed(t)},De=function(e){var t=e.currencies,n=Object(u.f)(),c=Object(a.useContext)(re),o=Object(a.useContext)(ee),l=o.settings,i=o.exchangeAmount,s=null,m=Object(a.useReducer)(Se,Object(_.a)({},Ae,{from:{currency:l.base,amount:null}})),d=Object(U.a)(m,2),E=d[0],b=d[1];Object(a.useEffect)((function(){b({type:"RATES_UPDATED",payload:{rates:c.rates}})}),[c]),Object(a.useEffect)((function(){b({type:"RESET_EXCHANGE"})}),[l.balances]);var p=Object.keys(t),v=l.balances[E.from.currency];E.from.amount>v&&(s="Insufficient Balance");var h=c.loading&&!E.rate?{from:"\u22c5\u22c5\u22c5",to:"\u22c5\u22c5\u22c5"}:{from:"".concat(t[E.from.currency]," 1"),to:"".concat(t[E.to.currency]," ").concat(Te(E.rate))};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i(E),e.target.reset(),n.push("/transactions")},"data-testid":"exchange-form"},r.a.createElement(y,null,r.a.createElement(we,{state:E.from,currencies:p,onCurrencyChange:function(e){c.updateBaseCurrency(e),b({type:"BASE_CURRENCY_UPDATED",payload:{value:e}})},onAmountChange:function(e){b({type:"BASE_AMOUNT_UPDATED",payload:{value:e}})}},r.a.createElement(ue,null,r.a.createElement(ie,null,"Balance: ",Te(v)),r.a.createElement(se,null,s||""))),r.a.createElement(ve,{values:h,onSwitchClick:function(){c.updateBaseCurrency(E.to.currency),b({type:"EXCHANGE_SWITCHED"})}}),r.a.createElement(we,{state:E.to,currencies:p,onCurrencyChange:function(e){b({type:"SECONDARY_CURRENCY_UPDATED",payload:{value:e}})},onAmountChange:function(e){b({type:"SECONDARY_AMOUNT_UPDATED",payload:{value:e}})}},r.a.createElement(ue,null,r.a.createElement(ie,null,"Balance:"," ",Te(l.balances[E.to.currency])))),r.a.createElement(f,{className:"m-2 inline-block",type:"submit","data-testid":"button-do-exchange"},"Exchange")))},Re={EUR:"\u20ac",GBP:"\xa3",USD:"$"},Ue=function(){return r.a.createElement(ae,null,r.a.createElement(p,null,r.a.createElement(De,{currencies:Re}),r.a.createElement(N,null,r.a.createElement(C,null,r.a.createElement(w,null,r.a.createElement(l.b,{to:"/settings"},"Settings")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/transactions"},"Transactions"))))))},_e=function(){var e=Object(a.useContext)(ee).settings;return r.a.createElement(p,null,r.a.createElement("header",null,r.a.createElement("h1",{className:"text-4xl pb-2"},"Transactions")),r.a.createElement(y,{width:"400px"},((null===e||void 0===e?void 0:e.transactions)||[]).map((function(e,t,n){return r.a.createElement("div",{className:"flex flex-row p-2 justify-between items-end  ".concat(n.length-1===t?"border-b-0":"border-b-2"),key:t},r.a.createElement("div",null,r.a.createElement("h3",{className:"text-2xl"},e.from.currency," \u2192 ",e.to.currency),r.a.createElement("span",{className:"text-xs text-green-900 font-bold"},e.from.amount," x ",e.rate," ="," ",e.to.amount)),r.a.createElement("div",{className:"text-xs text-gray-500"},"on ",new Date(e.timestamp).toLocaleString()))}))),r.a.createElement(N,null,r.a.createElement(C,null,r.a.createElement(w,null,r.a.createElement(l.b,{to:"/settings"},"Settings")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/exchange"},"Exchange")))))},ke=function(){var e=Object(a.useContext)(ee).settings;return r.a.createElement(p,null,r.a.createElement("header",null,r.a.createElement("h1",{className:"text-4xl pb-2"},"Balance"),r.a.createElement("p",null,"We have set it ourselves to EUR and credited your account some initial fund to play with the app")),r.a.createElement(y,{width:"400px"},e.currencies.map((function(t,n,a){var c=function(e,t){var n="middle";switch(0===e&&(n="start"),e===t-1&&(n="last"),n){case"start":return"flex flex-row px-3 pb-2 justify-between items-end border-b-2";case"last":return"flex flex-row px-3 pt-2 justify-between items-end";default:return"flex flex-row px-3 py-2 justify-between items-end border-b-2"}}(n,a.length);return r.a.createElement("div",{className:c,key:t},r.a.createElement("div",null,t),r.a.createElement("div",{className:"text-sm text-gray-900 font-bold"},e.balances[t]||0))}))),r.a.createElement(N,null,r.a.createElement(C,null,r.a.createElement(w,null,r.a.createElement(l.b,{to:"/exchange"},"Exchange")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/settings"},"Settings")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/transactions"},"Transactions")))))},Pe=function(){var e=Object(a.useContext)(ee).settings;return r.a.createElement(p,null,r.a.createElement("header",null,r.a.createElement("h1",{className:"text-4xl pb-2"},"Settings")),r.a.createElement(y,{width:"300px"},r.a.createElement("div",{className:"flex flex-row px-3 pb-2 justify-between items-end border-b-2"},r.a.createElement("div",null,"Base Currency"),r.a.createElement("div",{className:"text-sm text-gray-900 font-bold"},e.base)),r.a.createElement("div",{className:"flex flex-row px-3 py-2 justify-between items-end border-b-2"},r.a.createElement("div",null,"Rate Refresh Interval"),r.a.createElement("div",{className:"text-sm text-gray-900 font-bold"},e.poll/1e3,"s")),r.a.createElement("div",{className:"flex flex-row px-3 pt-2 justify-between items-end"},r.a.createElement("div",null,"Currencies"),r.a.createElement("div",{className:"text-sm text-gray-900 font-bold"},e.currencies.join(", ")))),r.a.createElement(N,null,r.a.createElement(C,null,r.a.createElement(w,null,r.a.createElement(l.b,{to:"/exchange"},"Exchange")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/balance"},"Balances")),r.a.createElement(w,null,r.a.createElement(l.b,{to:"/transactions"},"Transactions")))))};var Be=function(){return r.a.createElement(Z,null,r.a.createElement("div",{className:"bg-gray-200","data-testid":"app"},r.a.createElement("div",{className:"container min-h-screen p-2 box-border mx-auto relative text-center"},r.a.createElement(l.a,null,r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/transactions"},r.a.createElement(_e,null)),r.a.createElement(u.a,{path:"/settings"},r.a.createElement(Pe,null)),r.a.createElement(u.a,{path:"/balance"},r.a.createElement(ke,null)),r.a.createElement(u.a,{path:"/exchange"},r.a.createElement(Ue,null)),r.a.createElement(u.a,{path:"/welcome"},r.a.createElement(S,null)),r.a.createElement(u.a,{path:"/"},r.a.createElement(A,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.f76bb577.chunk.js.map